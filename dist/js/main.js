let catalog=null,assistantConfig=null,currentCategory=null;const SPEC_LABELS={capacidade_total:"Capacidade Total",capacidade_refrigerador:"Refrigerador",capacidade_freezer:"Freezer",consumo_kwh:"Consumo Mensal",largura_cm:"Largura",altura_cm:"Altura",profundidade_cm:"Profundidade",peso_kg:"Peso",dispenser_agua:"Dispenser de √Ågua",tipo:"Tipo",frost_free:"Frost Free",cor:"Cor",selo_procel:"Selo Procel"},SPEC_UNITS={capacidade_total:"L",capacidade_refrigerador:"L",capacidade_freezer:"L",consumo_kwh:"kWh/m√™s",largura_cm:"cm",altura_cm:"cm",profundidade_cm:"cm",peso_kg:"kg"};function openSidebar(e){const t=document.getElementById("sidebar"),o=document.getElementById("sidebar-overlay"),r=window.innerWidth<=1024;r&&(t.classList.add("open"),o&&o.classList.add("open"),document.body.style.overflow="hidden"),e&&setTimeout(()=>{toggleCategory(e);const o=document.querySelector(`[onclick*="toggleCategory('${e}')"]`);o&&t&&o.scrollIntoView({behavior:"smooth",block:"start"})},r?300:100)}function closeSidebar(){const e=document.getElementById("sidebar"),t=document.getElementById("sidebar-overlay");e&&e.classList.remove("open"),t&&t.classList.remove("open"),document.body.style.overflow=""}let currentTableFontSize=12;function changeTableFontSize(e){const t=document.querySelector(".compare-table");if(!t)return void console.log("changeTableFontSize: table not found");currentTableFontSize=Math.max(8,Math.min(20,currentTableFontSize+e)),t.style.fontSize=currentTableFontSize+"px";const o=t.querySelectorAll("th, td"),r=Math.max(3,Math.min(12,currentTableFontSize/3));o.forEach(e=>{e.style.padding=`${r}px ${1.2*r}px`}),console.log("Font size changed to:",currentTableFontSize)}function hideCompareCounter(){const e=document.getElementById("compare-counter");e&&(e.style.display="none",e.classList.remove("show"))}function toggleSidebar(){const e=document.getElementById("sidebar");e&&e.classList.contains("open")?closeSidebar():openSidebar()}function handleOverlayClick(){closeSidebar(),hideCompareToast()}function showComparePrompt(){const e=document.getElementById("compare-prompt"),t=document.getElementById("compare-prompt-products"),o=document.getElementById("compare-prompt-hint"),r=document.getElementById("compare-prompt-btn-compare"),a=document.getElementById("compare-counter");if(!e||!t||0===compareList.length)return void hideCompareToast();a&&(a.classList.remove("show"),a.style.display="none"),t.innerHTML=compareList.map(e=>{const t=e.editorialScores?.overall?`${e.editorialScores.overall}/10`:"";return`\n                <div class="compare-prompt-product">\n                    <span>‚úì ${e.brand} ${e.model}</span>\n                    <span style="color:#10b981;font-weight:600">${t}</span>\n                </div>\n            `}).join("");const n=4-compareList.length;compareList.length<2?(o.textContent=`+${2-compareList.length} para comparar`,o.style.color="#f59e0b",r.classList.add("disabled"),r.disabled=!0):(o.textContent=n>0?`+${n} dispon√≠vel`:"M√°ximo atingido",o.style.color="#64748b",r.classList.remove("disabled"),r.disabled=!1),e.style.display="block"}function hideCompareToast(){const e=document.getElementById("compare-prompt"),t=document.getElementById("compare-counter");if(e&&(e.style.display="none"),t&&compareList.length>0){const e=t.querySelector(".compare-counter-number"),o=t.querySelector(".compare-counter-text");e&&(e.textContent=compareList.length),o&&(o.textContent=1===compareList.length?"produto":"produtos"),t.style.display="flex",t.classList.add("show")}}function closeComparePrompt(){hideCompareToast()}function startComparisonFromPrompt(){hideCompareToast(),closeSidebar(),"function"==typeof showComparison&&showComparison()}function navigateToProduct(e,t){showProduct(e,t);const o=`/produto/${e}/${t}`;history.pushState({page:"product",category:e,product:t},"",o)}function toggleCategory(e){e.classList.toggle("open")}function showHome(){document.getElementById("page-home").style.display="block",document.getElementById("page-category").style.display="none",document.getElementById("page-product").style.display="none",document.getElementById("page-comparison").style.display="none",document.getElementById("header-title").textContent="Bem-vindo ao ComparaTop",document.getElementById("breadcrumb").innerHTML='<a href="#" onclick="showHome(); return false;">In√≠cio</a>',document.querySelectorAll(".nav-subcategory").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".nav-category-header").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".nav-product-item").forEach(e=>e.classList.remove("active")),document.querySelector(".sidebar-nav > .nav-category-header").classList.add("active"),window.innerWidth<=1024&&closeSidebar()}async function showCategory(e){const t={geladeiras:"geladeira",freezers:"freezer",frigobares:"frigobar"}[e]||e;currentCategory=t,window.scrollTo(0,0),document.querySelector(".main-content")?.scrollTo(0,0),document.getElementById("page-home").style.display="none",document.getElementById("page-category").style.display="block",document.getElementById("page-product").style.display="none",document.getElementById("page-comparison").style.display="none",document.getElementById("loading").style.display="block",document.getElementById("products-grid").innerHTML="",document.getElementById("error").style.display="none";const o={geladeira:"Geladeiras",geladeiras:"Geladeiras",freezer:"Freezers",freezers:"Freezers",frigobar:"Frigobares",frigobares:"Frigobares"}[e]||e;document.getElementById("header-title").textContent=o,document.getElementById("category-title").textContent=o,document.getElementById("breadcrumb").innerHTML=`\n                <a href="#" onclick="showHome(); return false;">In√≠cio</a> / \n                <a href="#" onclick="showCategory('${t}'); return false;">${o}</a>\n            `,document.querySelectorAll(".nav-subcategory").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".nav-category-header").forEach(e=>e.classList.remove("active")),window.innerWidth<=1024&&closeSidebar();try{const o=await fetch(`/data/catalogs/${t}.json`);if(!o.ok)throw new Error(`Catalog fetch failed: ${o.status}`);currentCatalog=await o.json(),catalog=currentCatalog;try{const t=await fetch(`/data/assistant/${e}.json`);t.ok&&(assistantConfig=await t.json())}catch(e){console.warn("Assistant config not available:",e)}document.getElementById("loading").style.display="none",document.getElementById("error").style.display="none",renderProducts()}catch(e){document.getElementById("loading").style.display="none",console.error("showCategory error:",e)}}function formatSpec(e,t){if(null==t)return"N/A";if("boolean"==typeof t)return t?"Sim":"N√£o";if(Array.isArray(t))return t.join(", ");const o=SPEC_UNITS[e]||"";return`${t}${o?" "+o:""}`}function renderProducts(){const e=currentCatalog&&currentCatalog.products?Object.values(currentCatalog.products).filter(e=>"active"===e.status):[];document.getElementById("products-grid").innerHTML=e.map(e=>`\n                <article class="product-card">\n                    <div class="product-header">\n                        <div>\n                            <div class="product-brand">${e.brand}</div>\n                            <div class="product-name">${e.model}</div>\n                        </div>\n                        <div class="product-score">${e.editorialScores?.overall||"N/A"}/10</div>\n                    </div>\n                    \n                    \x3c!-- Specs principais --\x3e\n                    <div class="specs-grid">\n                        ${["capacidade_total","capacidade_freezer","consumo_kwh","largura_cm"].map(t=>`\n                            <div class="spec-item">\n                                <span class="spec-label">${SPEC_LABELS[t]||t}</span>\n                                <span class="spec-value">${formatSpec(t,e.specs[t])}</span>\n                            </div>\n                        `).join("")}\n                    </div>\n                    \n                    \x3c!-- Todas as ofertas --\x3e\n                    <h4 style="font-size:0.95rem;margin:1rem 0 0.5rem;color:var(--c-primary-dark);">üõí Onde comprar (menor ‚Üí maior)</h4>\n                    <div class="offers-list">\n                        ${renderOffers(e)}\n                    </div>\n                    \n                    \x3c!-- Editorial Scores --\x3e\n                    <details style="margin-top:1rem;">\n                        <summary style="cursor:pointer;font-weight:600;font-size:0.9rem;color:var(--c-primary);">üìä Notas Editoriais (0-10)</summary>\n                        <div class="editorial-scores">\n                            ${renderEditorialScores(e)}\n                        </div>\n                    </details>\n                    \n                    \x3c!-- VoC Section --\x3e\n                    <details style="margin-top:1rem;" open>\n                        <summary style="cursor:pointer;font-weight:600;font-size:0.9rem;color:var(--c-primary);">üó£Ô∏è Voz do Cliente (s√≠ntese de ${e.voc?.sample?.totalApprox?.toLocaleString("pt-BR")||"?"} avalia√ß√µes)</summary>\n                        <div class="voc-section" style="margin-top:0.5rem;box-shadow:none;padding:1rem;">\n                            ${renderVoC(e)}\n                        </div>\n                    </details>\n                    \n                    \x3c!-- Compare Button - PROMINENT --\x3e\n                    <button class="compare-btn" data-product-id="${e.id}" onclick="toggleCompare('${e.id}', '${e.name}')">\n                        ‚öñÔ∏è Comparar este produto\n                    </button>\n                    \n                    \x3c!-- View Product Details Button --\x3e\n                    <a href="/produto/geladeira/${e.id}" \n                       onclick="event.preventDefault(); navigateToProduct('geladeira', '${e.id}');" \n                       class="btn" \n                       style="display:block;text-align:center;margin-top:0.5rem;background:var(--c-primary);color:#fff;text-decoration:none;">\n                        üìã Ver Ficha T√©cnica Completa\n                    </a>\n                </article>\n            `).join("")}function renderOffers(e){if(!e.offers||!e.offers.length)return'<p style="color:var(--c-muted);font-size:0.9rem;">Sem ofertas dispon√≠veis</p>';const t=[...e.offers].filter(e=>e.url).sort((e,t)=>null==e.price?1:null==t.price?-1:e.price-t.price);let o="";return t.map(e=>{const t=e.price?Utils.formatBRL(e.price):"Ver pre√ßo";return e.lastUpdated&&(!o||e.lastUpdated>o)&&(o=e.lastUpdated),`\n                    <a href="${e.url}" class="offer-btn ${e.retailerId}" target="_blank" rel="sponsored nofollow noopener"\n                       aria-label="Ver oferta na ${e.retailerName} por ${t}">\n                        <span class="retailer">${e.retailerName}</span>\n                        <span class="price">${t}</span>\n                    </a>\n                `}).join("")+(o?`<div class="offers-updated">Atualizado: ${Utils.formatDateTime(o)}</div>`:"")}function renderEditorialScores(e){const t=e.editorialScores;return t?(catalog.scoringTopics||[]).map(e=>{const o=t[e.id];if(null==o)return"";const r="object"==typeof o?o.score:o,a="object"==typeof o?o.note:null;if(null==r)return"";const n=10*r;let s="medium";return r>=8?s="high":r<6&&(s="low"),`\n                    <div class="editorial-topic" onclick="toggleScoreNote(this)">\n                        <span style="font-size:1rem;">${e.icon||"üìä"}</span>\n                        <span class="editorial-topic-label">${e.label}</span>\n                        <span class="editorial-topic-score">${r.toFixed(1)}</span>\n                        <div class="editorial-topic-bar">\n                            <div class="editorial-topic-bar-fill ${s}" style="width:${n}%"></div>\n                        </div>\n                        ${a?`<div class="score-note-inline" style="display:none;">${a}</div>`:""}\n                    </div>\n                `}).join(""):'<p style="color:var(--c-muted);">Notas editoriais n√£o dispon√≠veis.</p>'}function renderVoC(e){const t=e.voc;if(!t)return'<p style="color:var(--c-muted);">Dados de VoC n√£o dispon√≠veis.</p>';let o="";return o+=`<span class="voc-badge ${t.sentimentClass||"mixed"}">${t.sentiment}</span>`,o+=`<div class="voc-oneliner">${t.oneLiner}</div>`,t.summary30s&&(o+=`<div class="voc-summary"><strong>üìñ Resumo em 30s:</strong> ${t.summary30s}</div>`),o+='<div class="voc-lists">',o+='<div class="voc-list">',o+='<div class="voc-list-title pros">üëç Elogios mais recorrentes</div>',o+="<ul>",(t.pros||[]).slice(0,4).forEach(e=>{o+=`<li>\n                    <span class="topic">${e.topic}</span>\n                    <span class="freq">${e.freq}</span>\n                    <span class="detail">${e.detail}</span>\n                </li>`}),o+="</ul></div>",o+='<div class="voc-list">',o+='<div class="voc-list-title cons">üëé Reclama√ß√µes mais recorrentes</div>',o+="<ul>",(t.cons||[]).slice(0,4).forEach(e=>{o+=`<li>\n                    <span class="topic">${e.topic}</span>\n                    <span class="freq">${e.freq}</span>\n                    <span class="detail">${e.detail}</span>\n                </li>`}),o+="</ul></div>",o+="</div>",o+='<div class="voc-sample">',o+=`<strong>üìä Amostra analisada:</strong> ~${t.sample?.totalApprox?.toLocaleString("pt-BR")||"?"} avalia√ß√µes`,t.sample?.breakdown&&(o+="<br><small>",o+=t.sample.breakdown.map(e=>`${e.source}: ~${(e.count||e.countApprox||0).toLocaleString("pt-BR")}`).join(" ¬∑ "),o+="</small>"),o+="</div>",t.sources&&t.sources.length&&(o+='<div class="voc-sources"><strong>üîó Fontes:</strong> ',o+=t.sources.slice(0,5).map(e=>`<a href="${e.url}" target="_blank" rel="nofollow noopener">${e.name}</a>`).join(""),o+="</div>"),o}function runAssistant(){if(!catalog)return;const e=parseFloat(document.getElementById("q-niche").value)||null,t=parseFloat(document.getElementById("q-budget-min").value)||null,o=parseFloat(document.getElementById("q-budget-max").value)||null,r=document.getElementById("q-freezer").value,a=document.getElementById("q-priority").value,n=document.getElementById("q-noise").value,s=Catalog.getProducts(catalog).map(s=>{let i=10*(s.editorialScores?.overall||5);const c=[],l=[];if(e){const t=4,o=s.specs.largura_cm+t;e>=o?(c.push(`Cabe no seu nicho de ${e} cm`),i+=20):(l.push(`N√£o cabe no espa√ßo (precisa ${o} cm)`),i-=100)}if(o&&s.bestPrice)if(s.bestPrice>o)l.push(`Acima do or√ßamento m√°ximo (${Utils.formatBRL(s.bestPrice)})`),i-=50;else if(t&&s.bestPrice<t);else{const e=o-s.bestPrice;e>200&&c.push(`${Utils.formatBRL(e)} abaixo do or√ßamento`)}switch(a){case"consumo":const e=s.editorialScores.consumo||5;i+=3*e,e>=8&&c.push("Destaque em consumo energ√©tico");break;case"freezer":const t=s.specs.capacidade_freezer||0;i+=.5*t,t>=100&&c.push(`Freezer grande (${t}L)`);break;case"funcoes":const o=s.editorialScores.funcionalidades||5;i+=3*o,o>=8&&c.push("Destaque em funcionalidades");break;case"espaco":i+=.5*(100-s.specs.largura_cm),c.push(`Largura: ${s.specs.largura_cm} cm`);break;case"custo":s.bestPrice&&(i+=1e4/s.bestPrice*10)}if("muito"===r&&(i+=.3*(s.specs.capacidade_freezer||0)),"sim"===n){const e=s.editorialScores.ruido||5;i+=2*e,e<6&&l.push("VoC indica reclama√ß√µes frequentes de ru√≠do")}return(s.idealFor||[]).slice(0,2).forEach(e=>{c.some(t=>t.includes(e.label))||c.push(e.label)}),{product:s,score:i,reasons:c.slice(0,4),warnings:l}});s.sort((e,t)=>t.score-e.score);const i=document.getElementById("assistant-results");let c='<h4 style="margin-bottom:1rem;color:var(--c-primary-dark);">üìã Recomenda√ß√µes para voc√™:</h4>';s.forEach((e,t)=>{c+=`\n                    <div class="result-card ${0===t?"winner":""}">\n                        <div class="result-header">\n                            <div>\n                                <h4 style="margin:0;">${t+1}. ${e.product.name}</h4>\n                                <p style="color:var(--c-muted);font-size:0.9rem;margin:0.25rem 0;">\n                                    Nota geral: ${e.product.editorialScores.overall}/10 ¬∑ \n                                    Score personalizado: ${e.score.toFixed(0)} pts\n                                </p>\n                            </div>\n                        </div>\n                        \n                        ${e.reasons.length?`\n                            <ul class="result-reasons">\n                                ${e.reasons.map(e=>`<li>${e}</li>`).join("")}\n                            </ul>\n                        `:""}\n                        \n                        ${e.warnings.length?`\n                            <div class="result-warnings">\n                                ‚ö†Ô∏è ${e.warnings.join(" ¬∑ ")}\n                            </div>\n                        `:""}\n                        \n                        \x3c!-- TODAS as ofertas, ordenadas --\x3e\n                        <h5 style="margin:1rem 0 0.5rem;font-size:0.9rem;">üõí Onde comprar:</h5>\n                        <div class="offers-list">\n                            ${renderOffers(e.product)}\n                        </div>\n                    </div>\n                `}),i.innerHTML=c,i.classList.add("show"),i.scrollIntoView({behavior:"smooth",block:"start"})}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".mobile-menu-btn");e&&e.addEventListener("click",e=>{e.preventDefault(),e.stopImmediatePropagation(),toggleSidebar()})}),window.navigate=function(e){window.innerWidth<=1024&&closeSidebar(),Router.navigate(e)};let searchTimeout=null;const searchInput=document.getElementById("search-input"),searchResults=document.getElementById("search-results");async function performSearch(e){const t=["geladeira"];let o=[];for(const e of t)try{const t=await Catalog.load(e),r=Catalog.getProducts(t);o=o.concat(r.map(t=>({...t,category:e})))}catch(e){}const r=e.toLowerCase();renderSearchResults(o.filter(e=>e.name.toLowerCase().includes(r)||e.brand.toLowerCase().includes(r)||e.model.toLowerCase().includes(r)||(e.tags||[]).some(e=>e.toLowerCase().includes(r))).slice(0,8),e)}function renderSearchResults(e,t){0===e.length?searchResults.innerHTML=`\n                    <div class="search-no-results">\n                        <p>Nenhum produto encontrado para "${t}"</p>\n                    </div>\n                `:searchResults.innerHTML=e.map(e=>`\n                    <div class="search-result-item" onclick="goToProduct('${e.category}', '${e.id}')">\n                        <div class="search-result-info">\n                            <div class="search-result-name">${e.brand} ${e.model}</div>\n                            <div class="search-result-brand">${e.name}</div>\n                        </div>\n                        <span class="search-result-score">${e.editorialScores?.overall||"?"}/10</span>\n                    </div>\n                `).join(""),searchResults.classList.add("show")}function goToProduct(e,t){searchResults.classList.remove("show"),searchInput.value="",showProduct(e,t)}searchInput.addEventListener("input",e=>{clearTimeout(searchTimeout);const t=e.target.value.trim();t.length<1?searchResults.classList.remove("show"):searchTimeout=setTimeout(()=>performSearch(t),300)}),searchInput.addEventListener("focus",()=>{searchInput.value.length>=1&&searchResults.classList.add("show")}),searchInput.addEventListener("keydown",e=>{if("Enter"===e.key){e.preventDefault();const t=searchResults.querySelector(".search-result-item");t?t.click():searchInput.value.trim().length>=1&&performSearch(searchInput.value.trim()).then(()=>{const e=searchResults.querySelector(".search-result-item");e&&e.click()})}}),document.addEventListener("click",e=>{e.target.closest(".search-container")||searchResults.classList.remove("show")}),document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&"k"===e.key&&(e.preventDefault(),searchInput.focus()),"Escape"===e.key&&(searchResults.classList.remove("show"),searchInput.blur())});let compareList=[];const MAX_COMPARE=4;function toggleCompare(e,t){const o=compareList.findIndex(t=>t.id===e);if(o>-1)compareList.splice(o,1);else{if(compareList.length>=4)return void alert("M√°ximo de 4 produtos para compara√ß√£o");const t=Catalog.getProducts(catalog).find(t=>t.id===e);t&&compareList.push(t)}updateCompareUI()}function updateCompareUI(){document.querySelectorAll(".compare-btn").forEach(e=>{const t=e.dataset.productId,o=compareList.some(e=>e.id===t);e.classList.toggle("selected",o),e.textContent=o?"‚úì Selecionado para compara√ß√£o":"‚öñÔ∏è Comparar este produto"});const e=document.getElementById("compare-bar"),t=document.getElementById("compare-bar-products"),o=document.getElementById("compare-counter");if(compareList.length>0){if(e&&e.classList.add("show"),o){o.classList.add("show");const e=o.querySelector(".compare-counter-number"),t=o.querySelector(".compare-counter-text");e&&(e.textContent=compareList.length),t&&(t.textContent=1===compareList.length?"produto":"produtos")}t&&(t.innerHTML=compareList.map(e=>`\n                        <div class="compare-bar-product">\n                            <span class="compare-bar-product-name">${e.brand} ${e.model}</span>\n                            <button class="compare-bar-remove" onclick="toggleCompare('${e.id}', '${e.name}')">‚úï</button>\n                        </div>\n                    `).join(""))}else e&&e.classList.remove("show"),o&&o.classList.remove("show")}function clearComparison(){compareList=[],updateCompareUI()}async function openFeaturedComparison(e,t){if(!currentCatalog)try{const e=await fetch("/data/catalogs/geladeira.json");currentCatalog=await e.json()}catch(e){return console.error("Failed to load catalog:",e),void alert("Erro ao carregar cat√°logo")}const o=currentCatalog.products[e],r=currentCatalog.products[t];if(!o||!r)return void alert("Produtos n√£o encontrados");compareList=[{id:e,name:o.name,...o},{id:t,name:r.name,...r}];const a=document.getElementById("compare-modal");document.getElementById("compare-modal-body").innerHTML=renderComparisonTable(),a.classList.add("show"),document.body.style.overflow="hidden"}function showComparison(){if(compareList.length<2)return void alert("Selecione pelo menos 2 produtos para comparar");const e=document.getElementById("compare-modal");document.getElementById("compare-modal-body").innerHTML=renderComparisonTable(),e.classList.add("show"),document.body.style.overflow="hidden"}function closeCompareModal(){document.getElementById("compare-modal").classList.remove("show"),document.body.style.overflow=""}function renderComparisonTable(){const e=compareList,t=currentCatalog?.scoringTopics||[];function o(t,o=!0){const r=e.map(e=>e.specs[t]||0),a=o?Math.max(...r):Math.min(...r);return e.filter(e=>(e.specs[t]||0)===a).map(e=>e.id)}let r='<table class="compare-table">';r+="<thead><tr><th></th>",e.forEach(e=>{r+=`<th class="product-cell">\n                    <div class="product-brand">${e.brand}</div>\n                    <div class="product-name">${e.model}</div>\n                    <span class="score-badge">${e.editorialScores?.overall||"?"}/10</span>\n                </th>`}),r+="</tr></thead>",r+="<tbody>";const a=e.filter(t=>t.bestPrice===Math.min(...e.map(e=>e.bestPrice||1/0))).map(e=>e.id);return r+="<tr><td><strong>üí∞ Melhor Pre√ßo</strong></td>",e.forEach(e=>{const t=a.includes(e.id),o=e.offers?.filter(e=>e.url).sort((e,t)=>(e.price||1/0)-(t.price||1/0))[0],n=o?.retailerName||o?.vendor||"Loja",s=e.bestPrice?o?.url?`<a href="${o.url}" target="_blank" rel="sponsored nofollow noopener" style="color:inherit;text-decoration:underline;font-weight:700;">${Utils.formatBRL(e.bestPrice)}</a><br><small style="font-size:0.75rem;color:var(--c-muted);">via ${n}</small>`:`${Utils.formatBRL(e.bestPrice)}<br><small style="font-size:0.75rem;color:var(--c-muted);">via ${n}</small>`:"N/A";r+=`<td class="${t?"winner":""}">${s}</td>`}),r+="</tr>",r+='<tr class="compare-section-header"><td colspan="'+(e.length+1)+'">üìê Especifica√ß√µes</td></tr>',["capacidade_total","capacidade_freezer","consumo_kwh","largura_cm","altura_cm","profundidade_cm","peso_kg"].forEach(t=>{const a=["capacidade_total","capacidade_freezer"].includes(t),n=["consumo_kwh","peso_kg"].includes(t)?o(t,!1):a?o(t,!0):[];r+=`<tr><td>${SPEC_LABELS[t]||t}</td>`,e.forEach(e=>{const o=n.includes(e.id);r+=`<td class="${o?"winner":""}">${formatSpec(t,e.specs[t])}</td>`}),r+="</tr>"}),r+='<tr class="compare-section-header"><td colspan="'+(e.length+1)+'">üìä Notas Editoriais</td></tr>',t.forEach(t=>{const o=function(t){const o=e.map(e=>{const o=e.editorialScores?.[t];return"object"==typeof o?o?.score:o}),r=Math.max(...o.filter(e=>"number"==typeof e));return e.filter(e=>{const o=e.editorialScores?.[t];return("object"==typeof o?o?.score:o)===r}).map(e=>e.id)}(t.id);r+=`<tr><td>${t.icon||"üìä"} ${t.label}</td>`,e.forEach(e=>{const a=e.editorialScores?.[t.id],n="object"==typeof a?a?.score:a,s=o.includes(e.id);r+=`<td class="${s?"winner":""}">${n?n.toFixed(1):"N/A"}</td>`}),r+="</tr>"}),r+='<tr class="compare-section-header"><td colspan="'+(e.length+1)+'">üó£Ô∏è Voz do Cliente</td></tr>',r+="<tr><td>üìä Nota Geral VoC</td>",e.forEach(e=>{let t=5;e.voc&&(t+=.5*((e.voc.pros?.length||0)-(e.voc.cons?.length||0)),"positive"===e.voc.sentimentClass?t+=1.5:"negative"===e.voc.sentimentClass&&(t-=1.5),t=Math.max(1,Math.min(10,t))),r+=`<td>${t.toFixed(1)}/10</td>`}),r+="</tr>",r+="<tr><td>Sentimento</td>",e.forEach(e=>{r+=`<td>${e.voc?.sentiment||"N/A"}</td>`}),r+="</tr>",r+="</tbody></table>",r}function calculateEnergy(){if(!catalog)return void alert("Por favor, selecione uma categoria primeiro");const e=parseFloat(document.getElementById("calc-tariff").value)||.85,t=document.getElementById("calc-voltage").value,o=Catalog.getProducts(catalog),r=document.getElementById("energy-results");let a='<div style="background:#f0f9ff;padding:1rem;border-radius:var(--radius-sm);margin-top:1rem;">';a+='<h4 style="margin-bottom:0.75rem;font-size:0.95rem;color:var(--c-primary-dark);">üí° Custo Estimado de Energia</h4>',a+='<table style="width:100%;font-size:0.85rem;border-collapse:collapse;">',a+='<tr style="border-bottom:1px solid var(--c-border);">',a+='<th style="text-align:left;padding:0.5rem;">Produto</th>',a+='<th style="text-align:right;padding:0.5rem;">kWh/m√™s</th>',a+='<th style="text-align:right;padding:0.5rem;">R$/m√™s</th>',a+='<th style="text-align:right;padding:0.5rem;">R$/ano</th>',a+="</tr>",[...o].sort((e,t)=>(e.specs.consumo_kwh||999)-(t.specs.consumo_kwh||999)).forEach((o,r)=>{let n=o.specs.consumo_kwh||0;"220"===t?n*=.95:"110"===t&&(n*=1.02);const s=n*e,i=12*s,c=0===r;a+=`<tr style="border-bottom:1px solid var(--c-border);${c?"background:#dcfce7;":""}">`,a+=`<td style="padding:0.5rem;${c?"font-weight:600;":""}">${o.model}${c?" ‚≠ê":""}</td>`,a+=`<td style="text-align:right;padding:0.5rem;">${n.toFixed(1)}</td>`,a+=`<td style="text-align:right;padding:0.5rem;font-weight:500;">R$ ${s.toFixed(2)}</td>`,a+=`<td style="text-align:right;padding:0.5rem;">R$ ${i.toFixed(2)}</td>`,a+="</tr>"}),a+="</table>",a+=`<p style="font-size:0.75rem;color:var(--c-muted);margin-top:0.5rem;">Tarifa: R$ ${e.toFixed(2)}/kWh | Voltagem: ${"both"===t?"Bivolt":t+"V"}</p>`,a+="</div>",r.innerHTML=a,r.style.display="block"}function checkNicheFit(){if(!catalog)return void alert("Por favor, selecione uma categoria primeiro");const e=parseFloat(document.getElementById("niche-width").value),t=parseFloat(document.getElementById("niche-height").value),o=parseFloat(document.getElementById("niche-depth").value),r=parseFloat(document.getElementById("niche-gap").value)||4;if(!e&&!t&&!o)return void alert("Por favor, informe pelo menos uma medida");const a=Catalog.getProducts(catalog),n=document.getElementById("niche-results");let s='<div style="margin-top:1rem;">';a.forEach(a=>{const n=a.specs,i={width:!e||n.largura_cm+r<=e,height:!t||n.altura_cm<=t,depth:!o||n.profundidade_cm+r<=o},c=i.width&&i.height&&i.depth;s+=`<div style="background:${c?"#dcfce7":"#fee2e2"};padding:1rem;border-radius:var(--radius-sm);margin-bottom:0.5rem;">`,s+='<div style="display:flex;justify-content:space-between;align-items:center;">',s+=`<strong style="color:${c?"#166534":"#991b1b"};">${c?"‚úÖ":"‚ùå"} ${a.model}</strong>`,s+=`<span style="font-size:0.85rem;color:var(--c-muted);">${c?"CABE!":"N√ÉO CABE"}</span>`,s+="</div>",s+='<div style="font-size:0.85rem;margin-top:0.5rem;color:var(--c-text);">',s+=`<span style="margin-right:1rem;">${i.width?"‚úì":"‚úó"} Largura: ${n.largura_cm} cm ${e?`(precisa ${n.largura_cm+r} cm)`:""}</span>`,s+=`<span style="margin-right:1rem;">${i.height?"‚úì":"‚úó"} Altura: ${n.altura_cm} cm</span>`,s+=`<span>${i.depth?"‚úì":"‚úó"} Profundidade: ${n.profundidade_cm} cm ${o?`(precisa ${n.profundidade_cm+r} cm)`:""}</span>`,s+="</div>",s+="</div>"}),s+="</div>",n.innerHTML=s,n.style.display="block"}function getShareUrl(){const e=compareList.map(e=>e.id).join(",");return`${window.location.origin}${window.location.pathname}?compare=${e}`}function getShareText(){return`üèÜ Confira minha compara√ß√£o de ${compareList.map(e=>e.model).join(" vs ")} no ComparaTop!`}function shareToSocial(e){const t=encodeURIComponent(getShareUrl()),o=encodeURIComponent(getShareText()),r=encodeURIComponent("Compara√ß√£o de Eletrodom√©sticos - ComparaTop");let a="";switch(e){case"whatsapp":a=`https://api.whatsapp.com/send?text=${o}%20${t}`;break;case"telegram":a=`https://t.me/share/url?url=${t}&text=${o}`;break;case"facebook":a=`https://www.facebook.com/sharer/sharer.php?u=${t}`;break;case"twitter":a=`https://twitter.com/intent/tweet?text=${o}&url=${t}`;break;case"email":a=`mailto:?subject=${r}&body=${o}%20${t}`;break;case"copy":return void copyToClipboard(getShareUrl())}a&&window.open(a,"_blank","width=600,height=400")}function copyToClipboard(e){navigator.clipboard.writeText(e).then(()=>{showToast()}).catch(()=>{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),showToast()})}function showToast(){const e=document.getElementById("share-toast");e.classList.add("show"),setTimeout(()=>e.classList.remove("show"),3e3)}function subscribeNewsletter(){const e=document.getElementById("newsletter-email").value.trim(),t=document.getElementById("nl-price").checked,o=document.getElementById("nl-new").checked,r=document.getElementById("nl-promo").checked;if(!e||!e.includes("@"))return void alert("Por favor, insira um email v√°lido.");if(!t&&!o&&!r)return void alert("Selecione pelo menos uma prefer√™ncia de comunica√ß√£o.");const a={email:e,preferences:{priceAlerts:t,newComparisons:o,weeklyPromos:r},subscribedAt:(new Date).toISOString()},n=JSON.parse(localStorage.getItem("comparatop_subscribers")||"[]"),s=n.findIndex(t=>t.email===e);s>-1?n[s]=a:n.push(a),localStorage.setItem("comparatop_subscribers",JSON.stringify(n)),document.getElementById("newsletter-form-container").style.display="none",document.getElementById("newsletter-success").style.display="block",console.log("Newsletter subscription:",a)}function trackChannel(e){const t=JSON.parse(localStorage.getItem("comparatop_channel_clicks")||"[]");t.push({channel:e,clickedAt:(new Date).toISOString()}),localStorage.setItem("comparatop_channel_clicks",JSON.stringify(t)),console.log(`Channel clicked: ${e}`);const o=encodeURIComponent(window.location.href),r=encodeURIComponent(document.title),a=encodeURIComponent("Confira essa an√°lise de produtos no ComparaTop!"),n={whatsapp:`https://wa.me/?text=${a}%20${o}`,telegram:`https://t.me/share/url?url=${o}&text=${a}`,facebook:`https://www.facebook.com/sharer/sharer.php?u=${o}`,instagram:"https://instagram.com",email:`mailto:?subject=${r}&body=${a}%20${o}`,x:`https://twitter.com/intent/tweet?url=${o}&text=${a}`,twitter:`https://twitter.com/intent/tweet?url=${o}&text=${a}`};n[e]&&window.open(n[e],"_blank","noopener,noreferrer")}function toggleProductGroup(e){e.classList.toggle("open")}function populateProductNav(){const e=document.getElementById("nav-geladeiras-products");if(e&&currentCatalog&&currentCatalog.products){const t=Object.values(currentCatalog.products).sort((e,t)=>{const o=e.editorialScores?.overall||0;return(t.editorialScores?.overall||0)-o});let o="";t.forEach(e=>{const t=e.editorialScores?.overall||0,r=t>=8?"#22c55e":t>=6?"#eab308":"#ef4444",a=`Geladeira ${e.brand} ${e.model} ${e.specs?.capacidade_total||""}L ${e.specs?.tipo||""} Frost Free - Nota ${t}/10`;o+=`<div class="nav-product-item" data-product-id="${e.id}" style="display:flex;align-items:center;gap:0.5rem;">\n                        <input type="checkbox" class="nav-compare-checkbox" onclick="event.stopPropagation(); toggleSidebarCompare('${e.id}', this.parentElement)" title="Adicionar √† compara√ß√£o" style="cursor:pointer;width:16px;height:16px;">\n                        <a href="/produto/geladeira/${e.id}" onclick="event.preventDefault(); navigateToProduct('geladeira', '${e.id}'); closeSidebar();" title="${a}" style="flex:1;display:flex;align-items:center;gap:0.5rem;text-decoration:none;color:inherit;cursor:pointer;">\n                            <img src="${e.imageUrl}" alt="${a}" class="nav-product-item-img" onerror="this.style.display='none'" loading="lazy" width="32" height="32">\n                            <span>${e.brand} ${e.model}</span>\n                        </a>\n                        <span class="nav-product-score" style="background:${r};color:#fff;padding:0.1rem 0.4rem;border-radius:10px;font-size:0.65rem;font-weight:600;">${t}</span>\n                    </div>`}),e.innerHTML=o,updateSidebarProductStates()}}function toggleSidebarCompare(e,t){if(!currentCatalog||!currentCatalog.products)return;const o=currentCatalog.products[e];if(!o)return;const r=o.editorialScores?.overall||0,a=compareList.findIndex(t=>t.id===e);if(a>=0)compareList.splice(a,1),t.classList.remove("selected"),t.style.background="";else{if(compareList.length>=4)return void alert("M√°ximo de 4 produtos para compara√ß√£o. Remova um antes de adicionar outro.");compareList.push({...o,id:e,score:r}),t.classList.add("selected"),t.style.background="rgba(16, 185, 129, 0.15)"}updateCompareUI(),showComparePrompt();try{localStorage.setItem("compareList",JSON.stringify(compareList))}catch(e){}}function updateSidebarProductStates(){document.querySelectorAll("#nav-geladeiras-products .nav-product-item").forEach(e=>{const t=e.dataset.productId,o=compareList.some(e=>e.id===t),r=e.querySelector(".nav-compare-checkbox");o?(e.classList.add("selected"),e.style.background="rgba(16, 185, 129, 0.15)",r&&(r.checked=!0)):(e.classList.remove("selected"),e.style.background="",r&&(r.checked=!1))})}function toggleScoreNote(e,t){const o=document.getElementById(e);o&&(document.querySelectorAll(".score-note-inline").forEach(t=>{t.id!==e&&(t.style.display="none")}),"none"===o.style.display||""===o.style.display?(o.style.display="block",o.scrollIntoView({behavior:"smooth",block:"nearest"})):o.style.display="none")}function showScoreTooltip(e){const t=e.dataset.noteId,o=e.dataset.color;t&&toggleScoreNote(t,o)}let currentProduct=null;function showProduct(e,t){currentCatalog&&currentCatalog.category.slug===e?displayProduct(t):fetch(`/data/catalogs/${e}.json`).then(e=>e.json()).then(e=>{currentCatalog=e,displayProduct(t)})}function displayProduct(e){const t=currentCatalog.products[e];if(!t)return;currentProduct=t,document.querySelectorAll(".nav-product-item").forEach(e=>e.classList.remove("active"));const o=document.querySelector(`.nav-product-item[data-product-id="${e}"]`);o&&o.classList.add("active"),document.getElementById("breadcrumb").innerHTML=`\n                <a href="#" onclick="showHome(); return false;">In√≠cio</a> ‚Ä∫ \n                <a href="#" onclick="showCategory('${currentCatalog.category.slug}'); return false;">${currentCatalog.category.name}</a> ‚Ä∫ \n                ${t.model}\n            `,document.getElementById("header-title").textContent=t.name,document.getElementById("page-home").style.display="none",document.getElementById("page-category").style.display="none",document.getElementById("page-comparison").style.display="none",document.getElementById("page-product").style.display="block";const r=compareList.some(e=>e.id===t.id),a=r?"‚úì Na compara√ß√£o":"‚ûï Adicionar ao comparador",n=r?"btn-compare-active":"",s=(t.offers||[]).filter(e=>e.price).sort((e,t)=>e.price-t.price),i=s[0]?.price,c=(currentCatalog.scoringTopics?.map(e=>e.id)||[]).map(e=>{const o=t.editorialScores?.[e];return"object"==typeof o?o?.score:o}).filter(e=>"number"==typeof e),l=c.length>0?c.reduce((e,t)=>e+t,0)/c.length:null,d=l>=8?"#22c55e":l>=6?"#eab308":"#ef4444",m={amazon:"#FF9900","mercado livre":"#FFE600","magazine luiza":"#0086FF",shopee:"#EE4D2D"},p=s.map((e,t)=>{const o=e.price===i,r=e.retailerName.toLowerCase(),a=m[r]||"#6b7280",n=o?'<span class="offer-badge">üèÜ Melhor Pre√ßo</span>':"";return`<a href="${e.url}" target="_blank" rel="sponsored nofollow noopener" \n                           class="offer-item ${o?"offer-best":""}" \n                           style="border-left: 4px solid ${a};"\n                           aria-label="Comprar na ${e.retailerName} por ${Utils.formatBRL(e.price)}">\n                            <div class="offer-retailer">\n                                ${n}\n                                <span class="offer-store">${e.retailerName}</span>\n                            </div>\n                            <div class="offer-price-action">\n                                <span class="offer-price">${Utils.formatBRL(e.price)}</span>\n                                <span class="offer-btn-small">Ver Oferta ‚Üí</span>\n                            </div>\n                        </a>`}).join(""),u=Object.entries(t.specs||{}).map(([e,t])=>{const o=currentCatalog.specDefinitions?.[e],r=(e=>{const t=currentCatalog.specDefinitions?.[e];return t?.label?t.label:e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())})(e),a=o?.unit||"";return`<div class="spec-item"><span class="spec-label">${r}</span><span class="spec-value">${"boolean"==typeof t?t?"Sim":"N√£o":t}${a?" "+a:""}</span></div>`}).join(""),g=(t.editorialScores,(currentCatalog.scoringTopics||[]).map((e,o)=>{const r=t.editorialScores?.[e.id],a="object"==typeof r?r?.score:r,n="object"==typeof r?r?.note:e.description;if(!a)return"";const s=a>=8?"#22c55e":a>=6?"#eab308":"#ef4444",i=n||"Avalia√ß√£o baseada em an√°lise editorial detalhada.",c=`score-note-${e.id}`;return`<div class="score-item-wrapper">\n                    <div class="score-item score-item-clickable" data-note-id="${c}" data-color="${s}" onclick="toggleScoreNote('${c}', '${s}')" style="cursor:pointer;">\n                        <span class="score-icon">${e.icon}</span>\n                        <span class="score-label">${e.label} <span style="font-size:0.7rem;color:#94a3b8;">‚ìò</span></span>\n                        <span class="score-value" style="color:${s}">${a.toFixed(1)}</span>\n                    </div>\n                    <div id="${c}" class="score-note-inline" style="display:none;background:#f1f5f9;padding:0.75rem;border-radius:var(--radius-sm);margin-top:0.25rem;font-size:0.85rem;color:#475569;border-left:4px solid ${s};">\n                        üìù <strong>Por que essa nota:</strong> ${i}\n                    </div>\n                </div>`}).join("")),f=(t.voc?.pros||[]).map(e=>`<li><strong>${e.topic}</strong>: ${e.detail}${e.mentions?` <em style="color:var(--c-muted);font-size:0.8rem;">(${e.mentions} men√ß√µes)</em>`:""}</li>`).join(""),v=(t.voc?.cons||[]).map(e=>`<li><strong>${e.topic}</strong>: ${e.detail}${e.mentions?` <em style="color:var(--c-muted);font-size:0.8rem;">(${e.mentions} men√ß√µes)</em>`:""}</li>`).join(""),y=(t.voc?.sources||[]).map(e=>`<a href="${e.url}" target="_blank" rel="nofollow noopener" style="display:inline-flex;align-items:center;gap:0.25rem;padding:0.25rem 0.5rem;background:#e5e7eb;border-radius:var(--radius-sm);text-decoration:none;color:var(--c-text);font-size:0.8rem;">${e.name} <span style="color:var(--c-muted);">(${e.count||"~"})</span></a>`).join(""),h=`\n                <section class="product-section" style="background:#f8fafc;border:1px solid #e2e8f0;border-radius:var(--radius);">\n                    <div style="display:flex;align-items:center;gap:0.75rem;margin-bottom:1rem;">\n                        <span style="background:linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);color:white;padding:0.5rem;border-radius:var(--radius-sm);font-size:1.25rem;">‚ö°</span>\n                        <div>\n                            <h3 style="margin:0;font-size:1.1rem;color:var(--c-primary-dark);">Calculadora de Consumo</h3>\n                            <p style="margin:0;font-size:0.8rem;color:var(--c-muted);">Quanto vai custar na conta de luz?</p>\n                        </div>\n                    </div>\n                    <div class="calculator-grid" style="display:grid;grid-template-columns:1fr auto;gap:1rem;align-items:end;">\n                        <div>\n                            <label style="font-size:0.85rem;font-weight:500;color:#475569;">Tarifa (R$/kWh):</label>\n                            <input type="number" id="energy-tariff-${t.id}" value="0.75" step="0.01" min="0"\n                                style="width:100%;padding:0.6rem;border:1px solid #cbd5e1;border-radius:var(--radius-sm);margin-top:0.25rem;font-size:0.95rem;">\n                        </div>\n                        <button class="btn" onclick="calculateEnergy('${t.id}', ${t.specs?.consumo_kwh||0})"\n                            style="padding:0.6rem 1.5rem;">Calcular</button>\n                    </div>\n                    <div id="energy-result-${t.id}" style="margin-top:1rem;display:none;"></div>\n                </section>`,b=`\n                <section class="product-section" style="background:#f8fafc;border:1px solid #e2e8f0;border-radius:var(--radius);">\n                    <div style="display:flex;align-items:center;gap:0.75rem;margin-bottom:1rem;">\n                        <span style="background:linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);color:white;padding:0.5rem;border-radius:var(--radius-sm);font-size:1.25rem;">üìê</span>\n                        <div>\n                            <h3 style="margin:0;font-size:1.1rem;color:var(--c-primary-dark);">Verificar Encaixe no Nicho</h3>\n                            <p style="margin:0;font-size:0.8rem;color:var(--c-muted);">Produto: ${t.specs?.largura_cm||"?"} √ó ${t.specs?.altura_cm||"?"} √ó ${t.specs?.profundidade_cm||"?"} cm (L√óA√óP)</p>\n                        </div>\n                    </div>\n                    <p style="font-size:0.85rem;color:#64748b;margin-bottom:0.75rem;">Suas medidas do nicho:</p>\n                    <div class="calculator-grid" style="display:grid;grid-template-columns:repeat(3, 1fr) auto;gap:0.75rem;align-items:end;">\n                        <div>\n                            <label style="font-size:0.8rem;font-weight:500;color:#475569;">Largura</label>\n                            <input type="number" id="niche-w-${t.id}" placeholder="${(t.specs?.largura_cm||0)+5}" min="0"\n                                style="width:100%;padding:0.5rem;border:1px solid #cbd5e1;border-radius:var(--radius-sm);margin-top:0.25rem;font-size:0.9rem;">\n                        </div>\n                        <div>\n                            <label style="font-size:0.8rem;font-weight:500;color:#475569;">Altura</label>\n                            <input type="number" id="niche-h-${t.id}" placeholder="${(t.specs?.altura_cm||0)+5}" min="0"\n                                style="width:100%;padding:0.5rem;border:1px solid #cbd5e1;border-radius:var(--radius-sm);margin-top:0.25rem;font-size:0.9rem;">\n                        </div>\n                        <div>\n                            <label style="font-size:0.8rem;font-weight:500;color:#475569;">Profundidade</label>\n                            <input type="number" id="niche-d-${t.id}" placeholder="${(t.specs?.profundidade_cm||0)+5}" min="0"\n                                style="width:100%;padding:0.5rem;border:1px solid #cbd5e1;border-radius:var(--radius-sm);margin-top:0.25rem;font-size:0.9rem;">\n                        </div>\n                        <button class="btn" onclick="checkNicheFitSingle('${t.id}')" \n                            style="padding:0.5rem 1.25rem;">Verificar</button>\n                    </div>\n                    <div id="niche-result-${t.id}" style="margin-top:1rem;display:none;"></div>\n                </section>`,$=l?`\n                <div class="overall-score-box" style="background:linear-gradient(135deg, ${d}20, ${d}10);border:2px solid ${d};border-radius:var(--radius);padding:1rem;margin-bottom:1rem;display:flex;align-items:center;justify-content:space-between;">\n                    <div>\n                        <strong style="font-size:1.1rem;color:var(--c-primary-dark);">‚≠ê Nota Geral</strong>\n                        <p style="margin:0.25rem 0 0;color:var(--c-muted);font-size:0.85rem;">M√©dia de ${c.length} crit√©rios avaliados</p>\n                    </div>\n                    <div style="font-size:2rem;font-weight:700;color:${d};">${l.toFixed(1)}</div>\n                </div>`:"";let w="";if(t.voc){const e="positive"===t.voc.sentimentClass?"background:#dcfce7;color:#166534;":"negative"===t.voc.sentimentClass?"background:#fee2e2;color:#991b1b;":"background:#fef3c7;color:#92400e;",o="positive"===t.voc.sentimentClass?"üëç Geralmente Positivo":"negative"===t.voc.sentimentClass?"üëé Geralmente Negativo":"‚öñÔ∏è Misto",r=t.voc.sample?.totalApprox?`<span style="color:var(--c-muted);font-size:0.85rem;">üìä Baseado em ${t.voc.sample.totalApprox.toLocaleString("pt-BR")}+ avalia√ß√µes</span>`:"",a=t.voc.summary30s?`\n                    <div class="voc-30s" style="background:#f8fafc;padding:1rem;border-radius:var(--radius-sm);margin-bottom:1rem;">\n                        <h4 style="margin:0 0 0.5rem;font-size:0.9rem;">üìù Resumo em 30 segundos</h4>\n                        <p style="margin:0;line-height:1.6;">${t.voc.summary30s}</p>\n                    </div>`:"",n=t.voc.sources?.length>0?`\n                    <div class="voc-sources" style="margin-top:1rem;padding-top:1rem;border-top:1px solid var(--c-border);">\n                        <h4 style="font-size:0.85rem;color:var(--c-muted);margin-bottom:0.5rem;">üìö Fontes consultadas</h4>\n                        <div style="display:flex;flex-wrap:wrap;gap:0.5rem;">${y}</div>\n                    </div>`:"";w=`\n                    <section class="product-section">\n                        <h3>üó£Ô∏è Opini√£o dos Compradores</h3>\n                        <div class="voc-header" style="display:flex;align-items:center;gap:1rem;margin-bottom:1rem;">\n                            <span class="voc-sentiment ${t.voc.sentimentClass||"neutral"}" style="padding:0.5rem 1rem;border-radius:var(--radius-sm);font-weight:600;${e}">${o}</span>\n                            ${r}\n                        </div>\n                        <p class="voc-summary">${t.voc.oneLiner}</p>\n                        ${a}\n                        <div class="voc-pros-cons">\n                            <div class="voc-pros">\n                                <h4>‚úÖ Pontos Positivos</h4>\n                                <ul>${f}</ul>\n                            </div>\n                            <div class="voc-cons">\n                                <h4>‚ö†Ô∏è Pontos de Aten√ß√£o</h4>\n                                <ul>${v}</ul>\n                            </div>\n                        </div>\n                        ${n}\n                    </section>`}let C=`\n                <div class="product-detail">\n                    <div class="product-detail-grid">\n                        <div class="product-detail-image">\n                            <img src="${t.imageUrl}" alt="${t.model}" onerror="this.style.display='none'">\n                        </div>\n                        <div class="product-detail-info">\n                            <h2 class="product-detail-model">${t.brand} ${t.model}</h2>\n                            \n                            \x3c!-- All Marketplace Offers --\x3e\n                            ${s.length>0?`\n                                <div class="offers-section">\n                                    <h4 style="margin-bottom:0.75rem;color:var(--c-primary-dark);">üí∞ Onde Comprar (menor ‚Üí maior pre√ßo)</h4>\n                                    <div class="offers-list-vertical">\n                                        ${p}\n                                    </div>\n                                </div>\n                            `:""}\n                            \n                            <button class="btn btn-compare-large ${n}" onclick="toggleProductCompare('${t.id}')" id="compare-btn-${t.id}">\n                                ${a}\n                            </button>\n                        </div>\n                    </div>\n\n                    \x3c!-- Ver outros modelos - Carrossel --\x3e\n                    ${(()=>{const e=Object.values(currentCatalog.products).filter(e=>e.id!==t.id).sort((e,t)=>(t.editorialScores?.overall||0)-(e.editorialScores?.overall||0)).slice(0,10);if(0===e.length)return"";const o=currentCatalog.category.slug;return`\n                    <section class="product-section compare-carousel-section">\n                        <h3>üîÑ Ver outros modelos</h3>\n                        <div class="compare-carousel-wrapper">\n                            <button class="carousel-btn carousel-prev" onclick="scrollCarousel(-1)">‚Äπ</button>\n                            <div class="compare-carousel" id="compare-carousel">\n                                ${e.map(e=>{const[r,a]=[t.id,e.id].sort(),n=`/comparar/${o}/${r}-vs-${a}/`,s=e.editorialScores?.overall,i=s?`<span class="carousel-score">${s.toFixed(1)}</span>`:"";return`<a href="${n}" class="carousel-item">\n                                <div class="carousel-item-content">\n                                    <span class="carousel-model">${e.model}</span>\n                                    <span class="carousel-brand">${e.brand}</span>\n                                    ${i}\n                                </div>\n                                <span class="carousel-cta">Comparar ‚Üí</span>\n                            </a>`}).join("")}\n                            </div>\n                            <button class="carousel-btn carousel-next" onclick="scrollCarousel(1)">‚Ä∫</button>\n                        </div>\n                    </section>`})()}\n\n                    <div class="product-detail-sections">\n                        \x3c!-- Specs Section --\x3e\n                        <section class="product-section">\n                            <h3>üìã Especifica√ß√µes</h3>\n                            <div class="specs-grid">\n                                ${u}\n                            </div>\n                        </section>\n\n                        \x3c!-- Editorial Scores --\x3e\n                        <section class="product-section">\n                            <h3>üìä Notas Editoriais</h3>\n                            ${$}\n                            <div class="scores-grid">\n                                ${g}\n                            </div>\n                        </section>\n\n                        \x3c!-- VoC Section --\x3e\n                        ${w}\n\n                        \x3c!-- 5-Question Quick Decision Quiz --\x3e\n                        <section class="product-section quiz-section" style="background:#f8fafc;border:1px solid #e2e8f0;border-radius:var(--radius);">\n                            <div style="display:flex;align-items:center;gap:0.75rem;margin-bottom:1rem;">\n                                <span style="background:linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);color:white;padding:0.5rem;border-radius:var(--radius-sm);font-size:1.25rem;">üéØ</span>\n                                <div>\n                                    <h3 style="margin:0;font-size:1.1rem;color:var(--c-primary-dark);">Decida em 30 Segundos</h3>\n                                    <p style="margin:0;font-size:0.8rem;color:var(--c-muted);">Este produto √© ideal para voc√™?</p>\n                                </div>\n                            </div>\n                            \n                            <div id="quiz-container-${t.id}" class="quiz-container"\n                                 data-product-id="${t.id}"\n                                 data-capacity="${t.specs?.capacidade_total||0}"\n                                 data-freezer="${t.specs?.capacidade_freezer||0}"\n                                 data-width="${t.specs?.largura_cm||0}"\n                                 data-noise="${t.editorialScores?.ruido||5}"\n                                 data-value="${t.editorialScores?.custo_beneficio||5}"\n                                 data-best-offer="${s[0]?.url||"#"}"\n                                 data-best-price="${s[0]?.price||0}">\n                                <div class="quiz-questions" id="quiz-questions-${t.id}"></div>\n                                <div class="quiz-result" id="quiz-result-${t.id}" style="display:none;"></div>\n                            </div>\n                        </section>\n                        ${h}\n                        ${b}\n                    </div>\n                </div>\n            `;document.getElementById("product-content").innerHTML=C,initQuiz(t.id),updateMetaTags(t),generateSchemaOrg(t)}function scrollCarousel(e){const t=document.getElementById("compare-carousel");t&&t.scrollBy({left:200*e,behavior:"smooth"})}function initQuiz(e){const t=document.getElementById(`quiz-container-${e}`);if(!t)return;const o=t.dataset,r=parseFloat(o.capacity)||0,a=parseFloat(o.freezer)||0,n=parseFloat(o.width)||0,s=parseFloat(o.noise)||5,i=parseFloat(o.value)||5,c=o.bestOffer||"#",l=parseFloat(o.bestPrice)||0,d=[{q:"Qual o tamanho da sua fam√≠lia/quantidade de pessoas?",options:["1-2 pessoas","3-4 pessoas","5+ pessoas"],ideal:r>=400?[2]:[0,1]},{q:"Voc√™ usa muito o freezer (congela muita comida)?",options:["Pouco uso","Uso moderado","Uso intenso"],ideal:a>=100?[1,2]:[0,1]},{q:"Qual a largura do espa√ßo dispon√≠vel (nicho)?",options:["At√© 65cm","65-75cm","Mais de 75cm"],ideal:n<=65?[0,1,2]:n<=72?[1,2]:[2]},{q:"Voc√™ √© sens√≠vel a ru√≠dos de eletrodom√©sticos?",options:["Muito sens√≠vel","Um pouco","N√£o me incomoda"],ideal:s>=7?[0,1,2]:[1,2]},{q:"O que √© mais importante para voc√™?",options:["Menor pre√ßo poss√≠vel","Melhor custo-benef√≠cio","Mais funcionalidades"],ideal:i>=8?[0,1]:[1,2]}],m=[],p=document.getElementById(`quiz-questions-${e}`),u=document.getElementById(`quiz-result-${e}`);function g(){m.length=0,u.style.display="none",p.style.display="block",p.querySelectorAll(".quiz-question").forEach((e,t)=>{e.classList.toggle("active",0===t),e.querySelectorAll(".quiz-option").forEach(e=>e.classList.remove("selected"))})}!function(){let e="";d.forEach((t,o)=>{e+=`\n                        <div class="quiz-question ${0===o?"active":""}" data-question="${o}">\n                            <div class="quiz-progress">Pergunta ${o+1} de 5</div>\n                            <p class="quiz-q-text">${t.q}</p>\n                            <div class="quiz-options">\n                                ${t.options.map((e,t)=>`\n                                    <button class="quiz-option" data-q="${o}" data-opt="${t}">${e}</button>\n                                `).join("")}\n                            </div>\n                        </div>\n                    `}),p.innerHTML=e,p.querySelectorAll(".quiz-option").forEach(e=>{e.addEventListener("click",function(){!function(e,t){m[e]=t;const o=p.querySelector(`[data-question="${e}"]`);o.querySelectorAll(".quiz-option").forEach((e,o)=>{e.classList.toggle("selected",o===t)}),setTimeout(()=>{e<4?(o.classList.remove("active"),p.querySelector(`[data-question="${e+1}"]`).classList.add("active")):function(){let e=0;d.forEach((t,o)=>{t.ideal.includes(m[o])&&e++});const t=e/5*100;let o,r,a;t>=80?(o="PERFEITO para voc√™!",r="#22c55e",a="‚úÖ"):t>=60?(o="Boa op√ß√£o, vale considerar!",r="#eab308",a="üëç"):(o="Talvez n√£o seja a melhor escolha",r="#ef4444",a="‚ö†Ô∏è"),p.style.display="none",u.style.display="block",u.innerHTML=`\n                    <div style="text-align:center;padding:1.5rem;background:linear-gradient(135deg, ${r}20, ${r}10);border:2px solid ${r};border-radius:var(--radius);">\n                        <div style="font-size:3rem;margin-bottom:0.5rem;">${a}</div>\n                        <div style="font-size:1.5rem;font-weight:700;color:${r};margin-bottom:0.5rem;">${o}</div>\n                        <div style="font-size:1rem;color:var(--c-muted);">Compatibilidade: ${t.toFixed(0)}% (${e}/5 crit√©rios)</div>\n                        ${t>=60?`\n                            <a href="${c}" target="_blank" rel="sponsored nofollow noopener" \n                               class="btn btn-buy" style="margin-top:1rem;display:inline-block;">\n                                üõí Comprar Agora - ${Utils.formatBRL(l)}\n                            </a>\n                        `:'\n                            <button onclick="showCategory(\'geladeira\');" class="btn" style="margin-top:1rem;">\n                                üîç Ver Outras Op√ß√µes\n                            </button>\n                        '}\n                        <button class="quiz-reset-btn" style="display:block;margin:1rem auto 0;background:none;border:none;color:var(--c-muted);cursor:pointer;text-decoration:underline;">\n                            Refazer quiz\n                        </button>\n                    </div>\n                `,u.querySelector(".quiz-reset-btn").addEventListener("click",g)}()},300)}(parseInt(this.dataset.q),parseInt(this.dataset.opt))})})}()}function startGlobalQuiz(){const e=document.getElementById("quiz-category-select"),t=e?e.value:"geladeira";if(!t)return void alert("Por favor, selecione uma categoria primeiro.");const o=document.getElementById("quiz-category-selector");o&&(o.style.display="none"),fetch(`/data/catalogs/${t}.json`).then(e=>e.json()).then(e=>{currentCatalog=e,runGlobalQuiz(t)}).catch(e=>{alert("Categoria ainda n√£o dispon√≠vel. Em breve!"),o&&(o.style.display="block")})}function runGlobalQuiz(){const e=document.getElementById("start-global-quiz-btn");let t=document.getElementById("hero-quiz-container");t&&null!==t.offsetParent||(t=document.getElementById("global-quiz-questions")),document.getElementById("global-quiz-result"),e&&(e.style.display="none");const o=[{q:"Qual o tamanho da sua fam√≠lia/quantidade de pessoas?",options:["1-2 pessoas","3-4 pessoas","5+ pessoas"],key:"familySize"},{q:"Voc√™ usa muito o freezer (congela muita comida)?",options:["Pouco uso","Uso moderado","Uso intenso"],key:"freezerUse"},{q:"Qual a largura do espa√ßo dispon√≠vel (nicho)?",options:["At√© 65cm","65-75cm","Mais de 75cm"],key:"width"},{q:"Voc√™ √© sens√≠vel a ru√≠dos de eletrodom√©sticos?",options:["Muito sens√≠vel","Um pouco","N√£o me incomoda"],key:"noise"},{q:"Qual seu or√ßamento m√°ximo?",options:["At√© R$ 2.500","R$ 2.500 - 4.000","Acima de R$ 4.000"],key:"budget"}],r={};let a=0;!function e(n){const s=o[n];t.innerHTML=`\n                    <div class="global-quiz-question" style="background:rgba(255,255,255,0.15);padding:1.5rem;border-radius:var(--radius);">\n                        <div style="font-size:0.85rem;opacity:0.8;margin-bottom:0.5rem;color:#ffffff;">Pergunta ${n+1} de 5</div>\n                        <p style="font-size:1.1rem;font-weight:600;margin-bottom:1rem;color:#ffffff;">${s.q}</p>\n                        <div style="display:flex;flex-direction:column;gap:0.5rem;">\n                            ${s.options.map((e,t)=>`\n                                <button class="global-quiz-opt" data-opt="${t}" \n                                    style="background:rgba(255,255,255,0.9);color:#1d4ed8;padding:0.75rem 1rem;border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:1rem;text-align:left;transition:all 0.2s;">\n                                    ${e}\n                                </button>\n                            `).join("")}\n                        </div>\n                    </div>\n                `,t.querySelectorAll(".global-quiz-opt").forEach(o=>{o.addEventListener("click",function(){r[s.key]=parseInt(this.dataset.opt),a<4?(a++,e(a)):function(){const e=Object.values(currentCatalog.products).map(e=>{let t=0;const o=e.specs||{},a=e.offers||[],n=a.length>0?Math.min(...a.map(e=>e.price||99999)):99999,s=o.capacidade_total||0;(0===r.familySize&&s<=350||1===r.familySize&&s>=300&&s<=450||2===r.familySize&&s>=400)&&t++;const i=o.capacidade_freezer||0;(0===r.freezerUse&&i<=80||1===r.freezerUse&&i>=60&&i<=120||2===r.freezerUse&&i>=100)&&t++;const c=o.largura_cm||0;(0===r.width&&c<=65||1===r.width&&c<=72||2===r.width)&&t++;const l=e.editorialScores?.ruido||5;return(0===r.noise&&l>=7||1===r.noise&&l>=5||2===r.noise)&&t++,(0===r.budget&&n<=2500||1===r.budget&&n>=2e3&&n<=4e3||2===r.budget&&n>=3e3)&&t++,{product:e,score:t,percent:t/5*100,lowestPrice:n}});e.sort((e,t)=>t.score-e.score);let o=`\n                    <div style="background:rgba(255,255,255,0.95);padding:1.5rem;border-radius:var(--radius);color:#1e293b;position:relative;">\n                        <button onclick="closeQuizResult()" style="position:absolute;top:0.5rem;right:0.5rem;background:none;border:none;font-size:1.5rem;cursor:pointer;color:#64748b;padding:0.25rem;">&times;</button>\n                        <h3 style="margin:0 0 1rem;color:#1d4ed8;">üèÜ Nossas Recomenda√ß√µes para Voc√™</h3>\n                        ${e.slice(0,3).map((e,t)=>{const o=e.percent>=80?"#22c55e":e.percent>=60?"#eab308":"#ef4444",r=0===t?"ü•á":1===t?"ü•à":"ü•â";return e.product.offers?.sort((e,t)=>e.price-t.price)[0],`\n                                <div style="display:flex;align-items:center;gap:1rem;padding:1rem;margin-bottom:0.5rem;background:#f8fafc;border-radius:var(--radius-sm);border-left:4px solid ${o};">\n                                    <span style="font-size:1.5rem;">${r}</span>\n                                    <div style="flex:1;">\n                                        <div style="font-weight:600;">${e.product.brand} ${e.product.model}</div>\n                                        <div style="font-size:0.85rem;color:#64748b;">Compatibilidade: ${e.percent.toFixed(0)}% ‚Ä¢ ${Utils.formatBRL(e.lowestPrice)}</div>\n                                    </div>\n                                    <a href="/produto/geladeira/${e.product.id}/" \n                                       onclick="closeQuizResult(); return true;" \n                                        style="background:#1d4ed8;color:white;padding:0.5rem 1rem;border-radius:var(--radius-sm);text-decoration:none;font-size:0.85rem;">\n                                        Ver Detalhes\n                                    </a>\n                                </div>\n                            `}).join("")}\n                        <div style="display:flex;gap:1rem;margin-top:1rem;justify-content:center;">\n                            <button onclick="closeQuizResult()" style="background:#22c55e;color:white;border:none;padding:0.75rem 1.5rem;border-radius:var(--radius-sm);cursor:pointer;font-size:0.95rem;">\n                                ‚úì Fechar\n                            </button>\n                            <button onclick="restartQuizFromResult()" style="background:#64748b;color:white;border:none;padding:0.75rem 1.5rem;border-radius:var(--radius-sm);cursor:pointer;font-size:0.95rem;">\n                                üîÑ Refazer Quiz\n                            </button>\n                        </div>\n                    </div>\n                `;t.innerHTML=o}()})})}(0)}function resetGlobalQuiz(){const e=document.getElementById("start-global-quiz-btn"),t=document.getElementById("global-quiz-questions"),o=document.getElementById("global-quiz-result"),r=document.getElementById("quiz-category-selector"),a=document.getElementById("quiz-category-select");r&&(r.style.display="block"),a&&(a.value=""),e&&(e.style.display="none"),t&&(t.style.display="block",t.innerHTML=""),o&&(o.style.display="none",o.innerHTML="")}function closeQuizResult(){const e=document.getElementById("hero-quiz-container"),t=document.getElementById("quiz-category-select-hero");e&&(e.innerHTML=""),t&&(t.value="")}function restartQuizFromResult(){const e=document.getElementById("quiz-category-select-hero");e&&e.value?startGlobalQuiz():closeQuizResult()}function toggleProductCompare(e){const t=currentCatalog.products[e];if(!t)return;const o=compareList.findIndex(t=>t.id===e);if(o>-1)compareList.splice(o,1);else{if(!(compareList.length<4))return void showToast("M√°ximo de 4 produtos na compara√ß√£o");compareList.push({id:e,...t})}const r=document.getElementById(`compare-btn-${e}`);if(r){const t=compareList.some(t=>t.id===e);r.textContent=t?"‚úì Na compara√ß√£o":"‚ûï Adicionar ao comparador",r.classList.toggle("btn-compare-active",t)}updateCompareUI(),showComparePrompt()}function calculateEnergy(e,t){const o=t*(parseFloat(document.getElementById(`energy-tariff-${e}`).value)||.75),r=12*o,a=document.getElementById(`energy-result-${e}`);a.style.display="block",a.innerHTML=`\n        <div style="background:#f0fdf4;border:1px solid #22c55e;border-radius:var(--radius-sm);padding:1rem;">\n            <div style="display:grid;grid-template-columns:repeat(2, 1fr);gap:1rem;text-align:center;">\n                <div>\n                    <div style="font-size:0.85rem;color:var(--c-muted);">Consumo Mensal</div>\n                    <div style="font-size:1.25rem;font-weight:700;color:var(--c-primary-dark);">${t} kWh</div>\n                </div>\n                <div>\n                    <div style="font-size:0.85rem;color:var(--c-muted);">Custo Mensal</div>\n                    <div style="font-size:1.25rem;font-weight:700;color:var(--c-success);">\n                        ${Utils.formatBRL(o)}</div>\n                </div>\n                <div style="grid-column:span 2;padding-top:0.5rem;border-top:1px solid #22c55e40;">\n                    <div style="font-size:0.85rem;color:var(--c-muted);">Custo Anual Estimado</div>\n                    <div style="font-size:1.5rem;font-weight:700;color:var(--c-success);">${Utils.formatBRL(r)}\n                    </div>\n                </div>\n            </div>\n        </div>\n        `}function checkNicheFitSingle(e){const t=currentCatalog.products[e];if(!t)return;const o=parseFloat(document.getElementById(`niche-w-${e}`).value),r=parseFloat(document.getElementById(`niche-h-${e}`).value),a=parseFloat(document.getElementById(`niche-d-${e}`).value),n=t.specs?.largura_cm||0,s=t.specs?.altura_cm||0,i=t.specs?.profundidade_cm||0,c=!o||n+4<=o,l=!r||s+4<=r,d=!a||i+4<=a,m=c&&l&&d,p=document.getElementById(`niche-result-${e}`);p.style.display="block";const u=m?"#dcfce7":"#fee2e2",g=m?"#22c55e":"#ef4444",f=m?"‚úÖ":"‚ùå",v=m?"O produto CABE no seu espa√ßo!":"O produto N√ÉO CABE no espa√ßo informado";p.innerHTML=` <div\n            style="background:${u};border:1px solid ${g};border-radius:var(--radius-sm);padding:1rem;">\n            <div style="font-size:1.25rem;font-weight:700;margin-bottom:0.5rem;">${f} ${v}</div>\n            <div\n                style="font-size:0.9rem;display:grid;grid-template-columns:repeat(3, 1fr);gap:0.5rem;margin-top:0.75rem;">\n                <div\n                    style="text-align:center;padding:0.5rem;background:rgba(255,255,255,0.5);border-radius:var(--radius-sm);">\n                    <div style="font-size:0.75rem;color:var(--c-muted);">Largura</div>\n                    <div>${c?"‚úì":"‚úó"} ${n} cm ${o?`‚Üí ${o} cm`:""}</div>\n                </div>\n                <div\n                    style="text-align:center;padding:0.5rem;background:rgba(255,255,255,0.5);border-radius:var(--radius-sm);">\n                    <div style="font-size:0.75rem;color:var(--c-muted);">Altura</div>\n                    <div>${l?"‚úì":"‚úó"} ${s} cm ${r?`‚Üí ${r} cm`:""}</div>\n                </div>\n                <div\n                    style="text-align:center;padding:0.5rem;background:rgba(255,255,255,0.5);border-radius:var(--radius-sm);">\n                    <div style="font-size:0.75rem;color:var(--c-muted);">Profundidade</div>\n                    <div>${d?"‚úì":"‚úó"} ${i} cm ${a?`‚Üí ${a} cm`:""}</div>\n                </div>\n            </div>\n            <p style="font-size:0.75rem;color:var(--c-muted);margin-top:0.5rem;">* Considerando folga m√≠nima de 4cm\n                para ventila√ß√£o</p>\n            </div>\n            `}function updateMetaTags(e){if(!e)return;const t=`${e.brand} ${e.model} - An√°lise Completa | ComparaTop`,o=`An√°lise ${e.name}: compare pre√ßos em ${e.offers?.length||0} lojas, veja avalia√ß√µes reais de ${e.voc?.sample?.totalApprox?.toLocaleString("pt-BR")||"milhares"} de compradores. Nota ${e.editorialScores?.overall||"N/A"}/10.`;document.title=t;let r=document.querySelector('meta[name="description"]');r||(r=document.createElement("meta"),r.name="description",document.head.appendChild(r)),r.content=o,updateOrCreateMeta("og:title",t),updateOrCreateMeta("og:description",o),updateOrCreateMeta("og:url",window.location.href)}function updateOrCreateMeta(e,t){let o=document.querySelector(`meta[property="${e}"]`);o||(o=document.createElement("meta"),o.setAttribute("property",e),document.head.appendChild(o)),o.content=t}function generateSchemaOrg(e){if(!e)return;const t=[...e.offers||[]].sort((e,t)=>e.price-t.price),o=t[0]?.price||0,r=t[t.length-1]?.price||0,a={"@context":"https://schema.org","@type":"Product",name:`${e.brand} ${e.model}`,description:e.voc?.oneLiner||`${e.name} - Geladeira ${e.specs?.tipo||""} ${e.specs?.capacidade_total}L`,brand:{"@type":"Brand",name:e.brand},sku:e.model,image:e.imageUrl,aggregateRating:{"@type":"AggregateRating",ratingValue:e.editorialScores?.overall||0,bestRating:10,worstRating:0,ratingCount:e.voc?.sample?.totalApprox||1},offers:{"@type":"AggregateOffer",lowPrice:o,highPrice:r,priceCurrency:"BRL",offerCount:t.length,availability:"https://schema.org/InStock"}};let n=document.getElementById("product-schema");n&&n.remove();const s=document.createElement("script");s.id="product-schema",s.type="application/ld+json",s.textContent=JSON.stringify(a),document.head.appendChild(s)}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("quiz-category-select"),t=document.getElementById("start-global-quiz-btn");e&&t&&e.addEventListener("change",function(){this.value?t.style.display="inline-block":t.style.display="none"})}),document.addEventListener("DOMContentLoaded",()=>{fetch("/data/catalogs/geladeira.json").then(e=>e.json()).then(e=>{currentCatalog=e,populateProductNav(),Router.on("home",()=>{showHome(),Utils.updateMetaTags({title:"ComparaTop - Compare antes de comprar",description:"Compare eletrodom√©sticos antes de comprar. An√°lise transparente com s√≠ntese de milhares de avalia√ß√µes reais.",url:"https://comparatop.com.br/",image:"https://comparatop.com.br/assets/og-image.png"})}),Router.on("category",({categoryId:e})=>{showCategory(e);const t={geladeira:"Geladeiras",freezer:"Freezers",frigobar:"Frigobares"}[e]||e;Utils.updateMetaTags({title:`${t} - Compare as Melhores | ComparaTop`,description:`Compare as melhores ${t.toLowerCase()} do Brasil. An√°lise baseada em milhares de avalia√ß√µes reais.`,url:`https://comparatop.com.br/categoria/${e}`,image:"https://comparatop.com.br/assets/og-image.png"})}),Router.on("product",({categoryId:e,productId:t})=>{showProduct(e,t),Catalog.load(e).then(o=>{const r=Catalog.getProduct(o,t);r&&(Utils.updateMetaTags({title:`${r.name} - Review e Pre√ßos | ComparaTop`,description:r.editorialScores?.notes||`An√°lise completa do ${r.name} com pr√≥s, contras e comparativo de pre√ßos.`,url:`https://comparatop.com.br/produto/${e}/${t}`,image:r.imageUrl?.startsWith("/")?`https://comparatop.com.br${r.imageUrl}`:r.imageUrl,type:"product"}),"function"==typeof injectProductSchema&&injectProductSchema(r))})}),Router.on("comparison",async e=>{const t=e.comparisonId;if(t&&t.includes("-vs-")){if(!currentCatalog)try{const e=await fetch("/data/catalogs/geladeira.json");currentCatalog=await e.json()}catch(e){return console.error("Failed to load catalog:",e),void showCategory("geladeira")}const[e,o]=t.split("-vs-"),r=currentCatalog.products[e],a=currentCatalog.products[o];r&&a?(compareList=[{id:e,...r},{id:o,...a}],showComparison()):showCategory("geladeira")}else showComparison()}),Router.init()}).catch(()=>{Router.on("home",showHome),Router.init()})}),document.addEventListener("DOMContentLoaded",()=>{window.innerWidth<=1024&&closeSidebar();const e=document.querySelector(".compare-counter");e&&(compareList&&0!==compareList.length||(e.style.display="none"))});