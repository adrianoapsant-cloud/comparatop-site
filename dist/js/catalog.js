const Catalog=function(){"use strict";const t={};function e(t,e){const r=validTopics.reduce((t,e)=>t+(e.weight||1),0);return Math.round(weightedSum/r*10)/10}function r(t){return Object.values(t.products).filter(t=>"active"===t.status)}return{load:async function(r){if(t[r])return t[r];try{const n=await fetch(`/data/catalogs/${r}.json`);if(!n.ok)throw new Error(`Catalog not found: ${r}`);const o=await n.json();return Object.values(o.products).forEach(t=>{!function(t,r){t.editorialScores||(t.editorialScores={}),null==t.editorialScores.overall&&(t.editorialScores.overall=e(t.editorialScores,r.scoringTopics)),t.bestPrice=function(t){if(!t.offers||!t.offers.length)return null;const e=t.offers.filter(t=>null!=t.price&&!1!==t.inStock).map(t=>t.price);return e.length?Math.min(...e):null}(t),t.bestOffer=function(t){if(!t.offers||!t.offers.length)return null;const e=t.offers.filter(t=>null!=t.price&&t.url&&!1!==t.inStock).sort((t,e)=>t.price-e.price);return e.length?e[0]:null}(t),t.avgRating=function(t){if(!t.thirdPartyRatings||!t.thirdPartyRatings.length)return null;const e=t.thirdPartyRatings.reduce((t,e)=>t+e.ratingValue,0);return Math.round(e/t.thirdPartyRatings.length*10)/10}(t)}(t,o)}),t[r]=o,o}catch(t){throw console.error(`[Catalog] Failed to load ${r}:`,t),t}},getProducts:r,getProduct:function(t,e){return t.products[e]||null},getProductsByIds:function(t,e){return e.map(e=>t.products[e]).filter(Boolean)},searchProducts:function(t,e){const n=e.toLowerCase().trim();return n?r(t).filter(t=>[t.name,t.brand,t.model,...t.tags||[]].join(" ").toLowerCase().includes(n)):r(t)},filterProducts:function(t,e){let n=r(t);return e.brand&&(n=n.filter(t=>t.brand.toLowerCase()===e.brand.toLowerCase())),null!=e.minPrice&&(n=n.filter(t=>t.bestPrice&&t.bestPrice>=e.minPrice)),null!=e.maxPrice&&(n=n.filter(t=>t.bestPrice&&t.bestPrice<=e.maxPrice)),null!=e.minCapacity&&(n=n.filter(t=>t.specs.capacidade_total>=e.minCapacity)),null!=e.maxWidth&&(n=n.filter(t=>t.specs.largura_cm<=e.maxWidth)),null!=e.minScore&&(n=n.filter(t=>t.editorialScores.overall>=e.minScore)),e.features&&e.features.length&&(n=n.filter(t=>e.features.every(e=>{const r=(t.features||[]).find(t=>t.id===e);return r&&!0===r.value}))),e.tags&&e.tags.length&&(n=n.filter(t=>e.tags.some(e=>(t.tags||[]).includes(e)))),n},getBrands:function(t){const e=new Set(r(t).map(t=>t.brand));return Array.from(e).sort()},getPriceRange:function(t){const e=r(t).map(t=>t.bestPrice).filter(t=>null!=t);return e.length?{min:Math.min(...e),max:Math.max(...e)}:{min:0,max:0}},getAllFeatures:function(t){const e={};return r(t).forEach(t=>{(t.features||[]).forEach(t=>{e[t.id]||(e[t.id]={id:t.id,label:t.label,count:0}),!0===t.value&&e[t.id].count++})}),Object.values(e).sort((t,e)=>e.count-t.count)},computeOverall:e}}();"undefined"!=typeof module&&module.exports&&(module.exports=Catalog);